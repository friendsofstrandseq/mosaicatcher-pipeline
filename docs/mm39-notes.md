# mm39 (Mouse GRCm39) Reference Data Notes

## Overview

This document describes the current state of mm39 reference data support in the MosaiCatcher pipeline, including important caveats and limitations.

## Available Reference Files

The following mm39 reference files are available:

### Reference Genome
- **Location**: `workflow/data/ref_genomes/mm39.fa`
- **Source**: Generated by Alvaro Delgado from UCSC mm39.fa.gz
- **Content**: Chromosomes 1-19, X, and Y only
- **Excluded**: Scaffold sequences (chrUn_*) and mitochondrial DNA (chrM)
- **BWA Index**: Pre-generated (.amb, .ann, .bwt, .pac, .sa, .fai files)

### GC Content Matrix
- **Location**: `workflow/data/GC/mm39.GC_matrix.txt.gz`
- **Resolution**: 200 kb windows
- **Generation**: Created using `faCount` tool on mm39.fa windows
- **Format**: Contains A, C, G, T counts and %GC per bin
- **Status**: Available in mosaicatcher-referencedata submodule

### Normalization/Blacklist File
- **Location**: `workflow/data/normalization/mm39/HGSVC.200000.txt`
- **Resolution**: 200 kb bins only
- **Source**: Generated from two mouse Strand-seq samples
- **Status**: Available in mosaicatcher-referencedata submodule

## Important Caveats

### 1. ChromX Normalization Issue

**Problem**: The HGSVC blacklist file was generated using an XO (male) control sample instead of the recommended XX (female) diploid sample.

**Impact**:
- Most of chrX was initially detected as "outlier" bins due to hemizygosity
- Bins were manually "rescued" by visual inspection of read count plots
- Only bins with truly low mappability were kept as blacklisted
- Normalization factors for rescued regions were manually set to 1.0

**Recommendation**:
- For production use with female samples, consider regenerating the blacklist with a high-quality XX control sample
- Alternatively, use centromere-only blacklisting (strandtools approach) instead of mappability-based blacklisting

### 2. Control Sample Details

**Samples used for blacklist generation**:
- **Control**: `LanexLorenzoNPCDMSO18holdSortUVLED` (XO karyotype, only one copy of chrX)
- **Test**: `PDAC10265wholeCellsp1`
- **Data location**: `/scratch/tweber/DATA/MC_DATA/ALVARO/mm39_dev/`

### 3. Missing Files

The following reference files are **NOT currently available** for mm39:

#### Segmental Duplications
- **Missing**: `workflow/data/segdups/segDups_mm39_UCSCtrack.bed.gz`
- **Impact**: SV calls in segmental duplication regions cannot be filtered
- **Workaround**: Proceed without segdup filtering, or generate from UCSC database
- **Status**: Configured in `config/config.yaml` but file does not exist

#### Additional HGSVC Resolutions
- **Missing**: 50 kb and 100 kb resolution HGSVC normalization files
- **Available**: Only 200 kb resolution
- **Impact**: Cannot use finer-resolution analysis with multistep normalization
- **Workaround**: Use default 200 kb window size only

#### Binning BED File
- **Missing**: `mm39.bin_200kb_all.bed` (for plotting/analysis)
- **Available**: `mm10.bin_200kb_all.bed` can be used as reference
- **Impact**: Minor - mainly affects standardized plotting

## Usage Recommendations

### For Standard Analysis
1. Use with 200 kb window size (`window: 200000` in config)
2. Be cautious with chrX results, especially for XX samples
3. Accept lack of segdup filtering or generate segdups file separately
4. Test thoroughly with known control samples before production use

### For Female (XX) Samples
- Extra scrutiny needed for chrX SV calls due to XO-based blacklist
- Consider excluding chrX from analysis or manual validation
- Future: regenerate HGSVC file with proper XX control

### For Male (XO/XY) Samples
- Current blacklist should be more appropriate
- Still validate chrX and chrY results carefully

## Generating Missing Files (Future Work)

### Segmental Duplications
```bash
# Download from UCSC
wget -O segDups_mm39.bed.gz \
  "http://hgdownload.soe.ucsc.edu/goldenPath/mm39/database/genomicSuperDups.txt.gz"

# Process and convert to BED format
# (Additional processing required to match expected format)
```

### HGSVC Blacklist (Proper XX Control)
1. Sequence or identify high-quality XX mouse sample
2. Use `mosaicatcher count` to generate bin counts
3. Apply `makeNorm.R` script (from StrandPhaseR/mosaicatcher)
4. Manually curate centromeric regions if needed

### Additional Resolutions
Generate 50 kb and 100 kb windows and repeat blacklist generation process.

## References

- Original mm39 files: `/g/korbel/shared/adelgado/mosaicatcher_reffiles_mm39/`
- README: `/g/korbel/shared/adelgado/mosaicatcher_reffiles_mm39/README.md`
- Generation script: `/g/korbel/shared/adelgado/mosaicatcher_reffiles_mm39/generate_gc_matrix.sh`
- Source data: `/scratch/tweber/DATA/MC_DATA/ALVARO/mm39_dev/`

## Last Updated
January 30, 2026
